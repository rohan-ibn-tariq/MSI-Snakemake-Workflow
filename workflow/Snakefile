"""
MSI Variant Detection and Analysis Workflow
==========================================

A comprehensive pipeline for simulating and detecting microsatellite instability (MSI) 
variants in human chromosome 22 using state-of-the-art bioinformatics tools.

Workflow Overview:
- Genome acquisition from Ensembl
- Tandem repeat discovery with PyTRF  
- Variant simulation using Mason toolkit
- MSI-targeted indel injection
- Probabilistic variant calling with VarLociraptor
- Statistical quantification and analysis

Tools: Mason, PyTRF, VarLociraptor, BCFtools
Reference: Human genome GRCh38, Chromosome 22
Output: MSI burden quantification and visualization
"""


include: "rules/data_preparation.smk"
include: "rules/simulation_processing.smk"
include: "rules/data_analysis.smk"


rule all:
    input:
        # Data preparation outputs
        "workflow/resources/genome.fasta",
        "results/msi-bed/genome.bed",
        "results/msi-bed/sample_test.bed",
        "results/repeats/pytrf_output.csv",
        # Simulation processing outputs
        "results/simulated-mason-variant/genome_sim_raw.vcf",
        "results/simulated-mason-variant/genome_sim.vcf",
        "results/msi-indels-vcf/genome_sim_indels.vcf",
        "results/msi-indels-vcf/genome_filtered.vcf",
        "results/simulated-bam/alignments.bam",
        "results/varlociraptor-calls/variants.bcf",
        # Analysis results outputs
        "results/varlociraptor-calls/variants.vcf",
        "results/msi-quantification/msi_variants_detailed.tsv",
