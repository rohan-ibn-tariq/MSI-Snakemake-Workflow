"""
MSI Variant Detection and Analysis Workflow
==========================================

A comprehensive pipeline for simulating and detecting microsatellite instability (MSI) 
variants in human chromosome 22 using state-of-the-art bioinformatics tools.

Workflow Overview:
- Genome acquisition from Ensembl
- Tandem repeat discovery with PyTRF  
- Variant simulation using Mason toolkit
- MSI-targeted indel injection
- Probabilistic variant calling with VarLociraptor
- Statistical quantification and analysis

Tools: Mason, PyTRF, VarLociraptor, BCFtools
Reference: Human genome GRCh38, Chromosome 22
Output: MSI burden quantification and visualization
"""


include: "rules/data_preparation.smk"
include: "rules/simulation_processing.smk"
include: "rules/data_analysis.smk"


rule all:
    input:
        # Data preparation outputs
        "workflow/resources/reference-sequence/genome.fasta",
        "workflow/resources/reference-sequence/genome.fasta.bwt"
        "results/data-preparation/repeats/pytrf_output.csv",
        "results/data-preparation/ms-bed/genome.bed",
        "results/data-preparation/ms-bed/sample_test.bed",
        # Simulation processing outputs
        "results/simulation-processing/simulated-mason-variant/genome_sim_raw.vcf",
        "results/simulation-processing/simulated-mason-variant/genome_sim.vcf",
        "results/simulation-processing/msi-indels-vcf/genome_sim_indels.vcf",
        "results/simulation-processing/simulated-bam/alignments.bam",
        "results/simulation-processing/varlociraptor-calls/variants.bcf",
        # Analysis results outputs
        "results/data-analysis/varlociraptor-calls/variants.vcf",
        "results/data-analysis/msi-quantification/chr22_report.html",
